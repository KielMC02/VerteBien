@model VerteBienV1.Models.HORARIOS

@{
    ViewBag.Title = "Editar mi Horario";
}
@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
<center>
    <img src="~/Imagenes/Verte Bien Transparente 2.png" width="128" height="128" style="margin-top:2%" />
    <h4>Establecer horario de trabajo</h4>
    <hr class="w-50" />
</center>
    @Html.ValidationSummary(true, "", new { @class = "text-danger" })
    @Html.HiddenFor(model => model.id_horario)

    @*<div class="form-group">
            @Html.LabelFor(model => model.id_usuario, "id_usuario", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.DropDownList("id_usuario", null, htmlAttributes: new { @class = "form-control" })
                @Html.ValidationMessageFor(model => model.id_usuario, "", new { @class = "text-danger" })
            </div>
        </div>*@
    <div class="container">
        <div class="card h-100 shadow-lg my-5 ">
            <div class="card-body">
                <div class="form-row row mt-4">
                    <div class="col-md-4 col-12 col-lg-4">
                        <div class="form-group ">
                            @Html.Label("Horario de apertura días semanales", htmlAttributes: new { @class = "control-label col-md-12 my-1 my-1" })
                                <div class="col-md-12" id="cars">
                                    @Html.DropDownList("semanalesInicio", null, htmlAttributes: new { @class = "form-control col-md-10 " })
                                    @Html.ValidationMessageFor(model => model.semanales_inicio, "", new { @class = "text-danger" })
                                </div>
                            </div>
                            @*Semanales Cierre*@
                            <div class="form-group ">
                                @Html.Label("Horario de cierre días semanales", htmlAttributes: new { @class = "control-label col-md-12 my-1" })
                                                                <div class="col-md-12" id="cars">
                                    @Html.DropDownList("semanalesCierre", null, htmlAttributes: new { @class = "form-control col-md-10 " })
                                    @Html.ValidationMessageFor(model => model.semanales_inicio, "", new { @class = "text-danger" })
                                </div>
                            </div>

                    </div>

                    <div class="col-md-4 col-12 col-lg-4">
                        @*Sabados Inicio*@
                        <div class="form-group">
                            @Html.Label("Horario de apertura los sábados", htmlAttributes: new { @class = "control-label col-md-12 my-1" })
                            <div class="col-md-12" id="cars">
                                @Html.DropDownList("sabadoInicio", null, htmlAttributes: new { @class = "form-control col-md-10 " })
                                @Html.ValidationMessageFor(model => model.semanales_inicio, "", new { @class = "text-danger" })
                            </div>
                        </div>
                        @*Sabados Cierre*@
                    <div class="form-group ">
                        @Html.Label("Horario de cierre los sábados", htmlAttributes: new { @class = "control-label col-md-12 my-1" })
                        <div class="col-md-12" id="cars">
                            @Html.DropDownList("sabadoCierre", null, htmlAttributes: new { @class = "form-control col-md-10 " })
                            @Html.ValidationMessageFor(model => model.semanales_inicio, "", new { @class = "text-danger" })
                        </div>
                    </div>



                    </div>
                    <div class="col-md-4 col-12 col-lg-4">

                        @*Domingos Inicio*@
                        <div class="form-group ">
                            @Html.Label("Horario de apertura los domingos", htmlAttributes: new { @class = "control-label col-md-12 my-1" })
                            <div class="col-md-12" id="cars">
                                @Html.DropDownList("domingoInicio", null, htmlAttributes: new { @class = "form-control col-md-10 " })
                                @Html.ValidationMessageFor(model => model.semanales_inicio, "", new { @class = "text-danger" })
                            </div>
                        </div>
                        @*Domingos Cierre*@
                    <div class="form-group ">
                        @Html.Label("Horario de cierre los domingos", htmlAttributes: new { @class = "control-label col-md-12 my-1" })
                        <div class="col-md-12" id="cars">
                            @Html.DropDownList("domingoCierre", null, htmlAttributes: new { @class = "form-control col-md-10 " })
                            @Html.ValidationMessageFor(model => model.semanales_inicio, "", new { @class = "text-danger" })
                        </div>
                    </div>



                    </div>





                    <center>
                        <div class="form-group col-md-12">
                            <div class="col-md-offset-2 col-md-10">
                                <button type="submit" class="btn text-white" style="background-color:#DBA312; margin-top:2%">Guardar Horario</button>
                            </div>
                        </div>
                    </center>
                </div>
            </div>
        </div>
    </div>
}

<script>
    window.onload = function () {
        function verificarHorarios() {
            var semanalesInicio = $('select[name="semanales_inicio"]').val();
            var semanalesCierre = $('select[name="semanales_cierre"]').val();
            var sabadoInicio = $('select[name="sabados_inicio"]').val();
            var sabadoCierre = $('select[name="sabados_cierre"]').val();
            var domingoInicio = $('select[name="domingo_inicio"]').val();
            var domingoCierre = $('select[name="domingo_cierre"]').val();

            if (semanalesInicio !== "7" && semanalesCierre !== "7" && parseInt(semanalesCierre) < parseInt(semanalesInicio)) {
                $('select[name="semanales_cierre"]').val(parseInt(semanalesInicio) + 1);
            }

            if (sabadoInicio !== "7" && sabadoCierre !== "7" && parseInt(sabadoCierre) < parseInt(sabadoInicio)) {
                $('select[name="sabados_cierre"]').val(parseInt(sabadoInicio) + 1);
            }

            if (domingoInicio !== "7" && domingoCierre !== "7" && parseInt(domingoCierre) < parseInt(domingoInicio)) {
                $('select[name="domingo_cierre"]').val(parseInt(domingoInicio) + 1);
            }
        }

        function actualizarEstado(entrada, salida, selector, status) {
            if (entrada === "7" && salida === "7") {
                $(selector).removeClass("switchOn");
                $(status).css('opacity', '1');
            } else {
                $(selector).addClass("switchOn");
                $(status).css('opacity', '0');
            }
        }

        function handleClickSwitch(selector, inicio, cierre, status) {
            var inicioValue = $('select[name="' + inicio + '"]').val();
            var cierreValue = $('select[name="' + cierre + '"]').val();

            if (inicioValue === "7" && cierreValue === "7") {
                $('#modalStatus').modal('show'); // abrir el modal de Bootstrap
            } else {
                $(selector).toggleClass("switchOn");

                if ($(selector).hasClass("switchOn")) {
                    $(status).css('opacity', '0');
                } else {
                    $('select[name="' + inicio + '"]').val("7");
                    $('select[name="' + cierre + '"]').val("7");
                    $(status).css('opacity', '1');
                }
            }
        }

        $('select[name="semanales_inicio"], select[name="semanales_cierre"]').change(function () {
            verificarHorarios();
            actualizarEstado(
                $('select[name="semanales_inicio"]').val(),
                $('select[name="semanales_cierre"]').val(),
                '.switch_1',
                '#status1'
            );
        });

        $('select[name="sabados_inicio"], select[name="sabados_cierre"]').change(function () {
            verificarHorarios();
            actualizarEstado(
                $('select[name="sabados_inicio"]').val(),
                $('select[name="sabados_cierre"]').val(),
                '.switch_2',
                '#status2'
            );
        });

        $('select[name="domingo_inicio"], select[name="domingo_cierre"]').change(function () {
            verificarHorarios();
            actualizarEstado(
                $('select[name="domingo_inicio"]').val(),
                $('select[name="domingo_cierre"]').val(),
                '.switch_3',
                '#status3'
            );
        });

        $('.switch_1').click(function () {
            handleClickSwitch('.switch_1', 'semanales_inicio', 'semanales_cierre', '#status1');
        });

        $('.switch_2').click(function () {
            handleClickSwitch('.switch_2', 'sabados_inicio', 'sabados_cierre', '#status2');
        });

        $('.switch_3').click(function () {
            handleClickSwitch('.switch_3', 'domingo_inicio', 'domingo_cierre', '#status3');
        });



    }
   
   



</script>